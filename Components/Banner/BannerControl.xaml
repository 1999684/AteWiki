<UserControl x:Class="AtelierWiki.Components.Banner.BannerControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             mc:Ignorable="d" 
             d:DesignHeight="300" d:DesignWidth="800"
             Name="BannerRoot"
             Loaded="UserControl_Loaded"
             Unloaded="UserControl_Unloaded"
             MouseEnter="UserControl_MouseEnter"
             MouseLeave="UserControl_MouseLeave">

    <Grid Background="#1A1A1A" ClipToBounds="True">
        <!-- 1. 核心显示层 (三层叠加) -->
        <Grid>
            <!-- A. 背景层 (底层，铺满) -->
            <Image x:Name="BannerBg" Stretch="UniformToFill" 
                   RenderOptions.BitmapScalingMode="HighQuality"/>

            <!-- B. 人物层 (靠右，高度与容器一致，保持比例) -->
            <Image x:Name="BannerPerson" 
                   HorizontalAlignment="Right"  
                   VerticalAlignment="Bottom" 
                   Stretch="Uniform"
                   RenderOptions.BitmapScalingMode="HighQuality"/>

            <!-- C. 图标层 (靠左，高度是容器的一半，上下居中) -->
            <!-- 技巧：使用Grid行定义 1*:2*:1* 来实现高度占 50% 且居中 -->
            <Grid HorizontalAlignment="Left" Width="400">
                <Grid.RowDefinitions>
                    <RowDefinition Height="*"/>
                    <!-- 上留白 25% -->
                    <RowDefinition Height="2*"/>
                    <!-- 图标占 50% -->
                    <RowDefinition Height="*"/>
                    <!-- 下留白 25% -->
                </Grid.RowDefinitions>

                <Image x:Name="BannerIcon" 
                       Grid.Row="1"
                       HorizontalAlignment="Left" 
                       Margin="50,0,0,0"
                       Stretch="Uniform"
                       RenderOptions.BitmapScalingMode="HighQuality"/>
            </Grid>

            <!-- D. 透明点击层 (覆盖全屏，用于触发点击跳转) -->
            <Rectangle Fill="Transparent" Cursor="Hand" 
                       MouseLeftButtonUp="BannerImage_MouseLeftButtonUp"/>
        </Grid>

        <!-- 2. 交互阴影遮罩 (鼠标悬停时两侧变黑) -->
        <Rectangle x:Name="ShadowOverlay" IsHitTestVisible="False" Opacity="0">
            <Rectangle.Fill>
                <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                    <GradientStop Color="#CC000000" Offset="0.0"/>
                    <GradientStop Color="#00000000" Offset="0.15"/>
                    <GradientStop Color="#00000000" Offset="0.85"/>
                    <GradientStop Color="#CC000000" Offset="1.0"/>
                </LinearGradientBrush>
            </Rectangle.Fill>
        </Rectangle>

        <!-- 3. 左切换按钮 -->
        <Button x:Name="PrevButton" Content="❮" 
                Width="100" HorizontalContentAlignment="Left"
                HorizontalAlignment="Left" VerticalAlignment="Stretch"
                Background="Transparent" Foreground="White" BorderThickness="0"
                FontSize="30" FontWeight="Bold" Cursor="Hand" Padding="20,0"
                Click="PrevButton_Click">
            <Button.RenderTransform>
                <TranslateTransform X="0" Y="0"/>
            </Button.RenderTransform>
            <Button.Style>
                <Style TargetType="Button">
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="Button">
                                <Border Background="{TemplateBinding Background}">
                                    <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" VerticalAlignment="Center" Margin="{TemplateBinding Padding}"/>
                                </Border>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                    <Style.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Trigger.EnterActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.X)" To="-5" Duration="0:0:0.15" AutoReverse="True" RepeatBehavior="Forever"/>
                                    </Storyboard>
                                </BeginStoryboard>
                            </Trigger.EnterActions>
                            <Trigger.ExitActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.X)" To="0" Duration="0:0:0.1"/>
                                    </Storyboard>
                                </BeginStoryboard>
                            </Trigger.ExitActions>
                        </Trigger>
                    </Style.Triggers>
                </Style>
            </Button.Style>
        </Button>

        <!-- 4. 右切换按钮 -->
        <Button x:Name="NextButton" Content="❯" 
                Width="100" HorizontalContentAlignment="Right"
                HorizontalAlignment="Right" VerticalAlignment="Stretch"
                Background="Transparent" Foreground="White" BorderThickness="0"
                FontSize="30" FontWeight="Bold" Cursor="Hand" Padding="20,0"
                Click="NextButton_Click">
            <Button.RenderTransform>
                <TranslateTransform X="0" Y="0"/>
            </Button.RenderTransform>
            <Button.Style>
                <Style TargetType="Button">
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="Button">
                                <Border Background="{TemplateBinding Background}">
                                    <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" VerticalAlignment="Center" Margin="{TemplateBinding Padding}"/>
                                </Border>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                    <Style.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Trigger.EnterActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.X)" To="5" Duration="0:0:0.15" AutoReverse="True" RepeatBehavior="Forever"/>
                                    </Storyboard>
                                </BeginStoryboard>
                            </Trigger.EnterActions>
                            <Trigger.ExitActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.X)" To="0" Duration="0:0:0.1"/>
                                    </Storyboard>
                                </BeginStoryboard>
                            </Trigger.ExitActions>
                        </Trigger>
                    </Style.Triggers>
                </Style>
            </Button.Style>
        </Button>

        <!-- 5. 页码指示器 -->
        <Border HorizontalAlignment="Right" VerticalAlignment="Bottom" 
                Margin="15" CornerRadius="15" Background="#88000000">
            <TextBlock x:Name="IndexIndicator" Text="1 / 3" 
                       Foreground="White" FontSize="12" FontWeight="SemiBold"
                       Margin="12,6"/>
        </Border>
    </Grid>

    <!-- 6. 动画触发器 -->
    <UserControl.Triggers>
        <EventTrigger RoutedEvent="MouseEnter">
            <BeginStoryboard>
                <Storyboard>
                    <DoubleAnimation Storyboard.TargetName="ShadowOverlay" Storyboard.TargetProperty="Opacity" To="1.0" Duration="0:0:0.3"/>
                </Storyboard>
            </BeginStoryboard>
        </EventTrigger>
        <EventTrigger RoutedEvent="MouseLeave">
            <BeginStoryboard>
                <Storyboard>
                    <DoubleAnimation Storyboard.TargetName="ShadowOverlay" Storyboard.TargetProperty="Opacity" To="0.0" Duration="0:0:0.3"/>
                </Storyboard>
            </BeginStoryboard>
        </EventTrigger>
    </UserControl.Triggers>
</UserControl>
